<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<!--  <img src= "biorg.png" width = "150" height = "50" > -->
		<title>PluMA</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="import" href="sections/welcome.html">
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

		<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	</head>

	<body>
		<div class="navbar">
			<img src= "biorg.png" width = "100" height = "40" >
			<span><a href ="#home">PluMA: Plugin-based Microboime analysis</a></span>
			<div class="dropdown">	
				<button type="button" name="load_data" id="load_data" class="dropbtn">SEARCH</button>
				<div class="dropdown-content">	
					<!-- Search for plug-ins -->
					<div class="spacingTitle"></div>
					
					<div class="AdvSearch_Background ">
						<div>
							<!-- <span class="material-icons">search</span> -->
							<input style="width: 450px; height: 30px"type="text" id="myInput" onkeyup="startFiltering()" placeholder="Type to search">
							<hr>
							<div style="padding-left: 10px">
								Last Modified: 
								<div id="getMeTime"></div> 
			
							</div>
						</div>
						
					</div>
					
					<div class="spacingContainer"></div>

					<!-- Filter Checkboxes  -->
					<form>
						<div class="multiselect" onclick="showCheckboxes()">
							<div class="overSelect"></div>
						</div>					
						<div id="checkboxes" class="row">
							<div class="columns">
								<!-- <input type="checkbox" id="fileconverters" onclick="checkboxClicked()">File Converters -->
								<ul><label for="one"><input type="checkbox" id="one" checked="false" data-type="fileconverters" onclick()="clickFilter()"/>File Converters</label></ul>
								<ul><label for="two"></label><input type="checkbox" id="transformations" onclick="checkboxClicked()"/>Transformations</label></ul>
								<ul><label for="three"><input type="checkbox" id="correlation" onclick="checkboxClicked()"/>Correlation</label></ul>
							</div>

							<div class="columns">
								<ul><label for="four"><input type="checkbox" id="visualization" onclick="checkboxClicked()"/>Visualization</label></ul>
								<ul><label for="five"><input type="checkbox" id="dissimilarity" onclick="checkboxClicked()"/>Dissimilarity</label></ul>
								<ul><label for="six"><input type="checkbox" id="centrality" onclick="checkboxClicked()"/>Centrality</label></ul>
							</div>

							<div class="columns">
								<ul><label for="seven"><input type="checkbox" id="clustering" onclick="checkboxClicked()"/>Clustering</label></ul>
								<ul><label for="eight"><input type="checkbox" id="timeseries" onclick="checkboxClicked()"/>Time Series</label></ul>
								<ul><label for="nine"><input type="checkbox" id="externaltools" onclick="checkboxClicked()"/>External tools</label></ul>
							</div>

							<div class="columns">
								<ul><label for="ten"><input type="checkbox" id="statistics" onclick="checkboxClicked()"/>Statistics</label></ul>
								<ul><label for="eleven"><input type="checkbox" id="miscellaneous" onclick="checkboxClicked()"/>Miscellaneous</label></ul>
								<ul><label for="twelve"><input type="checkbox" id="favorites" onclick="checkboxClicked()"/>Favorites</label></ul>
							</div>
						</div>
					</form>
					<div class="spacingContainer"></div>
					<form>
						<div class="spacingTitle"></div>
						<!-- <div class="spacingTitle"></div> -->
						<table>
							<tr> 
								<th>Plugins</th>
								<th>Descriptions</th>
							</tr>					
							</div>
						</table>
						<!-- <img  id= "starFavorites" src="starFavorites.png" style="width: 5px; height: 5px;"/> -->
						<div id="details_table"></div>
					</form> 
					<div class="spacingContainer"></div>
				</div>
			</div>	
		</div> <!-- Close navbar-->
		<div class="spacingContainer"></div>
			
		<!-- Recently Used -->
		
		<div style="margin-left: 50px; ">
			<div style="width:auto; height:60px;">
				<button onclick="iPushContent('Demo1')" id="custom-IFB">Recently used</button>
				<!-- <i class="fa fa-caret-down"></i> -->
				<div id="Demo1" class="w3-hide w3-container">
					<table>
						<tr>
							<td>This will be a plugin using C++ for synthesizers.</td>
						</tr>
						<tr>
							<td>This will be a plugin using C++ for synthesizers.</td>
						</tr>
						<tr>
							<td>This will be a plugin using C++ for synthesizers.</td>
						</tr>
					</table>		
				</div>
			</div>
		</div>			
		<!-- <div id="wrapper"></div> -->
		

		<div id = "top-column" style="margin-left:50px; margin-top: 5px;">
			<!-- Drag and Drop Feature  *Rishabh-->
			<div id="pluginVertical">
				<div id = "plugin" ondrop = "handlePluginDrop(ev)" ondragover="allowDrop(event)">
					<div style="margin-top:100px; margin-left:50px;">	
						<input type="file" id="input-file" hidden="hidden" /> 
						<button type="button" id="custom-IFB-blue">INPUT FILE</button><br> 
					</div>
					<div class= "empty" id="file">
						<img id="deleteButton" src= "trash.png" onclick="deletePlugin(this)"/>
					</div>
					<img id="deleteButton" src= "master_trash.png" onclick="deleteStage(this)"/>
					<img id= "plus-sign" src="plus_sign.png" onclick= "addHorizontalPlugin(this)"/>
					<div id="upload-output-file" style="margin-left:55px; margin-top: 5px;">
						<input type="file" id="output-file" hidden="hidden"/>
						<button type="button" id="custom-OFB-blue">OUTPUT FILE</button><br>
						
					</div>
					<br>
				</div>
			</div>
		</div>


		<div id="add-plugin-btn" style="margin-left: 50px; margin-top: 5px;">
			<button type="button" id="add-plugin-inner" onclick="addPluginBox(this)">Add Stage</button>
		</div>

		
		<script>
			// create output file browser button
			createFileBrowserBtn(document.getElementById("output-file"), document.getElementById("custom-OFB"), document.getElementById("custom-OFB-text")); 
		</script>
			

		<!-- Footer -->
		<footer id="footer" class="wrapper style1-alt">
			<div class="inner"></div>	
		</footer>

		<!-- Scripts -->
      <script>window.$ = window.jQuery = require('./assets/js/jquery.min.js');</script>
		<script>window.i18n = new(require('./translations/i18n'));</script>
		<script src="assets/js/jquery.scrollex.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		<script src="assets/js/skel.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>
		<script src="assets/js/PlugInPool.js"></script>
      <script>
        require('./assets/js/menu')
				require('./assets/js/translations')
				require('./assets/js/ipc')
				require('./assets/js/dialog')
	  </script>
	  
		<!-- Choosing plugin from the pluma feature *cesia*-->
		<!-- <div class="container">
			<div class="box">
				<p id="demo"></p>
			</div>
		</div> -->
<div> </div>


	<script>
		const testFolder = '/Users/Ivonne/Desktop/PluMA/plugins';
		const fs = require('fs');

		const plugin_folders_fullpath = fs.readdirSync(testFolder)
		.map(function (file_path) {
			return testFolder + '/' + file_path;
		})
		.filter(function (absolute_file_path) {
			const fileInfo = fs.lstatSync(absolute_file_path);
			if (!fileInfo.isDirectory()) {
				return false;
			}
			return fs.existsSync(absolute_file_path + '/README.md');
		});

		const plugin_folders_input_output = plugin_folders_fullpath
		.map(function(total_file_path){
			var input_output = fs.readFileSync(total_file_path + '/README.md', 'utf8');
			input_output = input_output.split("\n");
			input_index = input_output.reduce(function (index, input_output, actual_index) {
				if (index !== -1) {
					return index;
				}

				if (input_output.substr(0, 10).toLowerCase().indexOf("input:") > -1) {
					 return actual_index;
				}

				return -1;
			}, -1);
			output_index = input_output.reduce(function (index, input_output, actual_index) {
				if (index !== -1) {
					return index;
				}

				if (input_output.substr(0, 10).toLowerCase().indexOf("output:") > -1) {
					 return actual_index;
				}

				return -1;
			}, -1);
			
			return [input_output[input_index].replace("# ","",1), input_output[output_index].replace("# ","",1)];

		});

		const plugin_folders = plugin_folders_fullpath
		.map(function (absolute_file_path) {
			return absolute_file_path.replace(testFolder + '/', '');
		});
		
		var flen, i , text;
		flen = plugin_folders.length;
		text = "<table>";
		for (i = 0; i < flen; i++) {
		text += "<tr>";
		text += "<td id = 'pname' class = 'a' draggable = true > " + plugin_folders[i] + "</td>";
		text += "<td draggable = true> " + plugin_folders_input_output[i] + "</td>";
		text += "</tr>";
		}
		text += "</table>";
		/*text = "<ul style='list-style-type: none';>";
		for (i = 1; i < flen; i++) {
		text += "<li class = 'a'> " + plugin_folders[i] + " - " 
			+ plugin_folders_input_output[0] + "</li>";
		}
		text += "</ul>";*/
		document.getElementById("demo").innerHTML = text;
	</script>

<div>


<!-- <h2 class= "text">Add and Install more Plugins</h2> -->
<!-- Trigger/Open The Modal -->
<!-- <button id="myBtn">Search Plugin Pool</button> -->

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
		<p id="bioOrg"></p>
  </div>

</div>

<script>
// Get the modal
var modal = document.getElementById('myModal');

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
btn.onclick = function() {
  modal.style.display = "block";
	openModal();
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
	closeModal();
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
		closeModal();
  }
}

function closeModal() {
	document.getElementById("bioOrg").innerHTML = '';
}

function openModal() {
	loadHtmlToModal('http://biorg.cs.fiu.edu/pluma/plugins/').then(() => {
		const child_process = require("child_process");
		const { dialog } = require("electron").remote;

		// Attach a click event listener to all plugin links so that when clicked, 
		// they fire a git clone
		[].slice.call(
			document
				.querySelectorAll("#bigcolumn table")[1]
				.querySelectorAll("table")).map(tableElem => {
					const rowList = [].slice.call(tableElem.querySelectorAll("tr"));
					rowList.shift();
					rowList.shift();
					return rowList;
				}).reduce((aggList, currInnerList) => {
					for (elem of currInnerList) {
						aggList.push(elem);
					}
					return aggList;
				}, [])
				.filter(rowElem => rowElem.querySelector("td:nth-child(3)").innerHTML == 'C++' || rowElem.querySelector("td:nth-child(3)").innerHTML == 'CUDA')
				.map(rowElem => rowElem.querySelector("a"))
				.forEach(aElem => { 
					aElem.addEventListener("click", (e) => {
						e.preventDefault();
						e.stopPropagation();
						child_process.exec(`git status`, {
							cwd: "/Users/Ivonne/Desktop/PluMA/plugins"
						}, (error, stdout, stderr) => {
							if (error) {
								dialog.showMessageBox({
									type: "error",
									title: "Plugin download error",
									message: `Plugin cant be downloaded, please refer to PluMA in order to recompile with C++ or CUDA`
								})
								return;
							}

							dialog.showMessageBox({
								type: "error",
								title: "Plugin download success",
								message: "Plugin cant be downloaded, please refer to PluMA in order to recompile with C++ or CUDA"
							});
						});
					});
				});

		[].slice.call(
			document
				.querySelectorAll("#bigcolumn table")[1]
				.querySelectorAll("table")).map(tableElem => {
					const rowList = [].slice.call(tableElem.querySelectorAll("tr"));
					rowList.shift();
					rowList.shift();
					return rowList;
				}).reduce((aggList, currInnerList) => {
					for (elem of currInnerList) {
						aggList.push(elem);
					}
					return aggList;
				}, [])
				.filter(rowElem => rowElem.querySelector("td:nth-child(3)").innerHTML != 'C++' && rowElem.querySelector("td:nth-child(3)").innerHTML != 'CUDA')
				.map(rowElem => rowElem.querySelector("a"))
				.forEach(aElem => { 
					aElem.addEventListener("click", (e) => {
						e.preventDefault();
						e.stopPropagation();
						child_process.exec(`git clone ${aElem.href}`, {
							cwd: "/Users/Ivonne/Desktop/PluMA/plugins"
						}, (error, stdout, stderr) => {
							
							if (error) {
								dialog.showMessageBox({
									type: "error",
									title: "Plugin download error",
									message: `Plugin was already downloaded at ${aElem.href} \n\n ${stderr} ${error}`
								})
								return;
							}

							dialog.showMessageBox({
								type: "info",
								title: "Plugin download success",
								message: "Plugin was successfully downloaded in the installed plugin list!"
							});
						});
					});
				});

				// Stop any link on loaded HTML to go anywhere
				document.getElementById("bioOrg").addEventListener("click", (e) => {
					e.preventDefault();
				});
	});
}

function loadHtmlToModal(webAddress) {
	var request = require('request');
	var cheerio = require('cheerio');

	return new Promise(function (resolve, reject) {
		request(webAddress, function(err, resp, html) {
			if (err) {
				reject(err);
				return;
			}

			const $ = cheerio.load(html);
			document.getElementById("bioOrg").innerHTML = html;
			resolve(html);
		});
	});
}

</script>
</div>

<script>

$.get('http://biorg.cs.fiu.edu/pluma/plugins/', function(response) {
  // console.log(response);
});

</script>

<br/>

	<script>
		function addHorizontalPlugin(i) {
			var outerDiv = document.createElement("div");
			outerDiv.id = "plugin"; 
			outerDiv.ondrop = "handlePluginDrop(ev)";
			outerDiv.ondragover = "allowDrop(event)"
			var inputDiv = document.createElement("div");
			inputDiv.style = "margin-top:100px; margin-left:50px;";
			var buttonInput = document.createElement("input");
			buttonInput.type = "file";
			buttonInput.id = "input-file";
			buttonInput.hidden = "hidden";
			inputDiv.appendChild(buttonInput);
			var buttonInputButton = document.createElement("button");
			buttonInputButton.type = "button";
			buttonInputButton.id = "custom-IFB-blue";
			buttonInputButton.textContent = "INPUT FILE";
			inputDiv.appendChild(buttonInputButton);
			outerDiv.appendChild(inputDiv);
			var innerDiv = document.createElement("div");
			innerDiv.className = "empty";
			innerDiv.id = "file";
			var deleteImg = document.createElement("img");
			deleteImg.src = "trash.png";
			deleteImg.id = "deleteButton"
			deleteImg.onclick = function(){deletePlugin(this)};
			innerDiv.appendChild(deleteImg);
			outerDiv.appendChild(innerDiv);
			var masterDeleteImg = document.createElement("img");
			masterDeleteImg.src = "master_trash.png";
			masterDeleteImg.id = "deleteButton"
			masterDeleteImg.onclick = function() {deleteStage(this)};
			outerDiv.appendChild(masterDeleteImg);
			var plusImg = document.createElement("img");
			plusImg.src = "plus_sign.png";
			plusImg.id = "plus-sign"
			plusImg.onclick = function() {addHorizontalPlugin(this)};
			outerDiv.appendChild(plusImg);
			var outputDiv = document.createElement("div");
			outputDiv.id = "upload-output-file";
			outputDiv.style = "margin-left:55px; margin-top: 5px;"
			var buttonOutput = document.createElement("input");
			buttonOutput.type = "file";
			buttonOutput.id = "output-file";
			buttonOutput.hidden = "hidden";
			outputDiv.appendChild(buttonOutput);
			var buttonOutputButton = document.createElement("button");
			buttonOutputButton.type = "button";
			buttonOutputButton.id = "custom-OFB-blue";
			buttonOutputButton.textContent = "OUTPUT FILE";
			outputDiv.appendChild(buttonOutputButton);
			outerDiv.appendChild(outputDiv);
			var br = document.createElement("br");
			outerDiv.appendChild(br);
			((i.parentNode).parentNode).appendChild(outerDiv);
			//Change the color grey back to blue now that there is a horizontal plugin
			if(document.contains(document.getElementById("custom-IFB-gray")))
			{
				var inputGray = document.getElementById("custom-IFB-gray");
				inputGray.id = "custom-IFB-blue";
			}
			if(document.contains(document.getElementById("custom-OFB-gray")))
			{
				var inputGray = document.getElementById("custom-OFB-gray");
				inputGray.id = "custom-OFB-blue";
			}
		}
	</script>

	<script>
		function deletePlugin(i) {
			(((i.parentNode).parentNode).parentNode).removeChild(i.parentNode.parentNode)
		}
	</script>

	<script>
		function deleteStage(i) {
			(((i.parentNode).parentNode).parentNode).removeChild(i.parentNode.parentNode)
		}
	</script>

	<script>
		function addPluginBox(i) {
			var outerDiv = document.createElement("div");
			outerDiv.id = "pluginVertical";
			var pluginDiv = document.createElement("div");
			pluginDiv.id = "plugin"; 
			pluginDiv.ondrop = "handlePluginDrop(ev)";
			pluginDiv.ondragover = "allowDrop(event)"
			var inputDiv = document.createElement("div");
			inputDiv.style = "margin-top:100px; margin-left:50px;";
			var buttonInput = document.createElement("input");
			buttonInput.type = "file";
			buttonInput.id = "input-file";
			buttonInput.hidden = "hidden";
			inputDiv.appendChild(buttonInput);
			var buttonInputButton = document.createElement("button");
			buttonInputButton.type = "button";
			if(document.contains(document.getElementById("custom-IFB-blue")))
			{
				buttonInputButton.id = "custom-IFB-gray";
				var buttonCollection = document.getElementsByTagName("button")
				var outputBlue = buttonCollection[buttonCollection.length - 2]
				outputBlue.id = "custom-OFB-gray";
			}
			else
			{
				buttonInputButton.id = "custom-IFB-blue";
			}
			buttonInputButton.textContent = "INPUT FILE";
			inputDiv.appendChild(buttonInputButton);
			pluginDiv.appendChild(inputDiv);
			var innerDiv = document.createElement("div");
			innerDiv.className = "empty";
			innerDiv.id = "file";
			var deleteImg = document.createElement("img");
			deleteImg.src = "trash.png";
			deleteImg.id = "deleteButton"
			deleteImg.onclick = function() {deletePlugin(this)};
			innerDiv.appendChild(deleteImg);
			pluginDiv.appendChild(innerDiv);
			var plusImg = document.createElement("img");
			plusImg.src = "plus_sign.png";
			plusImg.id = "plus-sign"
			plusImg.onclick = function() {addHorizontalPlugin(this)};
			pluginDiv.appendChild(plusImg);
			var masterDeleteImg = document.createElement("img");
			masterDeleteImg.src = "master_trash.png";
			masterDeleteImg.id = "deleteButton"
			masterDeleteImg.onclick = function() {deleteStage(this)};
			pluginDiv.appendChild(masterDeleteImg);
			var outputDiv = document.createElement("div");
			outputDiv.id = "upload-output-file";
			outputDiv.style = "margin-left:55px; margin-top: 5px;";
			var buttonOutput = document.createElement("input");
			buttonOutput.type = "file";
			buttonOutput.id = "output-file";
			buttonOutput.hidden = "hidden";
			outputDiv.appendChild(buttonOutput);
			var buttonOutputButton = document.createElement("button");
			buttonOutputButton.type = "button";
			buttonOutputButton.id = "custom-OFB-blue";
			buttonOutputButton.textContent = "OUTPUT FILE";
			outputDiv.appendChild(buttonOutputButton);
			pluginDiv.appendChild(outputDiv);
			var br = document.createElement("br");
			pluginDiv.appendChild(br);
			outerDiv.appendChild(pluginDiv);
			document.getElementById("top-column").appendChild(outerDiv);
		}
	</script>

	

	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

			
	<script>

		//once the save button is clicked, the filenames are saved into a text file
		function parseInput(event){
			require('fs');
			var data = 	document.getElementById("file").textContent;
			var inputName = document.getElementById("custom-IFB-text").textContent;
			var outputName = document.getElementById("custom-OFB-text").textContent;
			
			var cl = document.getElementById("file").className;
			var cl2 = document.getElementsByClassName("empty");
			

			inputName = inputName.trim()
			fs.writeFileSync('assets/config.txt', inputName + "\n", (err) => {throw err});

			data = data.trim();
			fs.appendFileSync('assets/config.txt', data + "\n", (err) => {throw err});

			for(var i =0; i < document.getElementsByClassName("empty").length; i++){
					var n = document.getElementsByClassName("empty")[i].textContent; 
					n = n.trim();
					fs.appendFileSync('assets/config.txt', n + "\n", (err) => {throw err});
			}
			outputName = outputName.trim()
			fs.appendFileSync('assets/config.txt', outputName + "\n", (err) => {throw err});
			alert("Data has been saved");
			

		}
		
    //calls function at the start of draggging the function
		document.addEventListener("dragstart", function(event) {
		  // sets the data type and the value of the dragged filename
		 event.dataTransfer.setData("text", event.target.textContent);
		  // Changes the opacity of the draggable element
		  event.target.style.opacity = "0.4";
			
		});
		
		
		//Resets the opacity to 1
		document.addEventListener("dragend", function(event) {
		  event.target.style.opacity = "1";
		});
				

		//The border is changed when the dragged filename enters the file_drag_area classes
		document.addEventListener("dragenter", function(event) {
			if(event.target.className == "file_drag_area" || event.target.className == "empty"){
			event.target.style.border = "3px dotted black";
			}
		});
		

		//allows user to dragover filenames
		document.addEventListener("dragover", function(event) {
		  event.preventDefault();
		});
		
		//the border is set back to normal once the filenames are dragged out of the empty class
		document.addEventListener("dragleave", function(event) {
			event.target.style.border = "";
		  
		});

		//generates random hash string for temporary filenames
		function hash(s){
  			return s.split("").reduce(
				function(a,b){
			 		a=((a<<5)-a)+b.charCodeAt(0);return a&a
				} ,0);              
		}	
		
		//the filenames in the empty classes are ready to be parsed
		//when dropped into the boxes
		document.addEventListener("drop", function(event) {
		  event.preventDefault();
			if(event.target.className == "file_drag_area" || event.target.className == "empty"){
				event.target.style.backgroundColor = "#FFFFE0";
				event.target.style.border = "";
				var node = document.createElement("UL");
				var tempNode = document.createElement("UL");
				node.id = "plugin";
				node.setAttribute('draggable', true);
				var d = document.createTextNode(event.dataTransfer.getData("text"));
				var random = hash(Math.random().toString(2));
				var temp = "\n" + random.toString();
				temp += ".CSV";
				var tempText = document.createTextNode(temp);
				node.appendChild(d);
				tempNode.appendChild(tempText);
				event.target.appendChild(node);
				event.target.appendChild(tempNode);
				console.log(tempNode);
				tempNode.style.visibility = "hidden";
			}
			
		});

		/** delete plugin code **/

		//calls function when draggable element is dropped
		//drops plugins into the trash can to be deleted
		function drop(ev){

			ev.preventDefault();
			var r = document.getElementById("plugin"); 
			var s = document.getElementsByClassName("empty");
			var txt = event.dataTransfer.getData("Text");
			var count  = r.parentNode.childElementCount;
			var count2 = s.length;
			var child_index = 0 ;
			var sec_index = 0 ;
			txt = txt.trim();
			console.log(txt);
			var str = "";
			console.log(s);
			for(var g =0; g < count2; g++){
				str = s[g].innerText.trim();
					if(txt === str){
						sec_index = g;
						break;
					}
			}
			var newStr = str.split("")

			str = s[sec_index].innerText.trim();
			console.log(str);

			if(txt === str){
				s[sec_index].innerText = "";
			}
			
			
			try{
				for (var i = 0; i < count; i++) {
						if(txt === r.parentNode.children[i].innerText){
							child_index = i;
							break;
						}
				}
			
				
				if(txt === r.parentNode.children[child_index].innerText){
					r.parentNode.children[child_index].innerText = "";
				}
			}
			catch(error){
				console.error(error);
			}
			//r.parentNode.children[0].innerText = " ";
			ev.target.style.opacity = "1";
			
		}

		//changes opacity when draggable element enters trash can div
		function dragenter(ev){
			ev.target.style.opacity = "0.4";
		}
		
		//changes opacity when draggable element leaves trash can div
		function dragleave(ev){
			ev.target.style.opacity = "1";
		}

		//changes opacity when dragging ends
		function dragend(ev){
			ev.target.style.opacity = "1";
		}

	</script> 

	<!-- <div  id="trash" ondrop="drop(event)" ondragenter="dragenter(event)" ondragleave="dragleave(event)" ondragend="dragend(event)">
		<img class = "trashcan" src= "trash.png" >
	</div>
	<button class= "button save" onclick="parseInput()">Save</button>
	
	<script src = "assets/js/drag.js"></script> -->

	  <!-- footer -->
	<footer class="site-footer">
		<div class="footer-container">
		  <div class="row">
			<div class="footer-about">
			  <h6>About</h6>
			  <p>School of Computing and Information Sciences <br> Florida International University <br>ECS-254 University Park Campus Miami, FL 33199 USA<br>E-mail: biorg.fiu@gmail.com or <br>giri.narasimhan@fiu.edu</p>
			</div>
  
			<div class="footer-links">
			  <h6>Helpful Links</h6>
			  <ul style="list-style-type: none;">
				<li><a href="http://biorg.cis.fiu.edu/pluma/">About PluMA</a></li>
				<li><a href="http://biorg.cis.fiu.edu/pluma/userguide.pdf">User Guide</a></li>
			  </ul>
			</div>
  
			<div class="footer-image">
				<img src="fiuscis.png" alt="FIU SCIS" width = "160" height = "60">
			</div>
		  </div>
		</div>
	</footer>
	</body>
</html>

<script type="module">
	$(document).ready(writeFullTable());
</script>

<script>
	function writeFullTable() {
  $.ajax({
    url: "./Web_Scraping/PluMA/results.csv",
    dataType: "text",
    success: function (data) {
      var pluginDetails = data.split(/\r?\n|\r/);
      var date;
	  var table_data = '<table class="table table-bordered table-striped">';

      for (var count = 0; count < pluginDetails.length; count++) {
        if (count == pluginDetails.length - 1) {
          date = pluginDetails[count]

          break;
        }
        var cell_data = pluginDetails[count].split(/[,]+/)
        table_data += '<tr>';
        if (cell_data.length >= 3) {
          cell_data[1] = cell_data[1].replace(/^"|"$/g, '');
          var site = cell_data[3] + '.git'; //need to use this to clone repo
          cell_data = cell_data.splice(0, 2);
          for (var cell_count = 0; cell_count < cell_data.length; cell_count++) {
            if (cell_count == 0) {
				table_data += `<td class='starFavorites' id=${cell_data[cell_count]}>` + `<img src='starFavorites.png' alt="star"></img>` + '</td>';
              table_data += `<td><a onclick="openTheWindow('${site}');">` + cell_data[cell_count] + ' draggable="true" ondragstart="dragPlugin(event)"</a></td>';     
            }
            else {
              table_data += '<td>' + cell_data[cell_count] + '</td>';
			}
          }
          table_data += '</tr>';
        }
      }
      table_data += '</table>';
      $('#details_table').html(table_data);
      document.getElementById("getMeTime").innerHTML = date;
    }
  });
}

function dragPlugin(ev) {
  ev.dataTransfer.setData("text", ev.target.id);
}

function handlePluginDrop(ev) {

	if (dragSrcEl !== this) {
      dragSrcEl.text = this.id;
    }

    return false;
}

function allowDrop(ev) {
  ev.preventDefault();
}

function openTheWindow(url) {
const child_process = require("child_process");
  child_process.exec(`git clone ${url}`, {
    cwd: "/Users/edwardpalermo/Desktop/seniorProject/PluMA/plugins"
  }, (error, stdout, stderr) => {
    
    if (error) {
      dialog.showMessageBox({
        type: "error",
        title: "Plugin download error",
        message: `Plugin was already downloaded at ${url} \n\n ${stderr} ${error}`
      })
      return;
    }

    dialog.showMessageBox({
      type: "info",
      title: "Plugin download success",
      message: "Plugin was successfully downloaded in the installed plugin list!"
    });
  });
}//we don't need this
</script>